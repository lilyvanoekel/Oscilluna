# Oscilluna: View

This is the UI of the synthesizer. It's a vite app build in typescript, mainly around [three.js](https://threejs.org/). When the [Cmajor](https://cmajor.dev/) tooling compiles the plugin, the build output of this package gets included in the bundle to provide the GUI.

## Development

- `npm run dev` starts the dev server.
- `npm run build` builds the view and updates the `dist` folder.
  - For any Cmajor tooling to pick up the changes (including previewing the patch in VSCode) the view has to be built first. The patch is linked to use `view/dist/index.js`. For this reason, the `dist` folder is committed to source control.
- `npm test` to run the tests.
- `view/index.js` is a special javascript file that serves as the entry point. This file is copied into the `dist` folder on build.
  - This sets up an iframe in which it loads the output generated by vite. It also provides the `patchConnection` object and defines scaling limits.
- Communication with the DSP code happens through the `patchConnection` object.
  - [Documentation](https://cmajor.dev/docs/PatchFormat#the-patchconnection-object)
  - An incomplete mock is available when running in development mode, outside of the context of Cmajor, in `view/src/mock-patch-connection.ts`.

## Current State

The view is in a bit of a state and could use a refactor and better test coverage. This should be judged as a creative endeavour first, and technical project second.
